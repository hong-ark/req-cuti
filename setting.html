<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>ADMIN SETTING LIBUR & CUTI</title>

<style>
body{
  font-family:'Segoe UI',Tahoma,Verdana,sans-serif;
  background:linear-gradient(135deg,#667eea,#764ba2);
  min-height:100vh;
  margin:0;
  display:flex;
  justify-content:center;
  align-items:center;
}
.container{
  background:#fff;
  width:420px;
  padding:30px 28px 35px;
  border-radius:18px;
  box-shadow:0 15px 35px rgba(0,0,0,.25);
  animation:fadeIn .5s ease;
}
h2{
  text-align:center;
  margin-bottom:20px;
  font-size:22px;
  font-weight:700;
  color:#4e54c8;
}
label{
  font-size:14px;
  font-weight:600;
  margin-top:14px;
  display:block;
  color:#333;
}
input, textarea{
  width:100%;
  margin-top:6px;
  padding:12px 14px;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:14px;
  box-sizing:border-box;
}
input:focus, textarea:focus{
  outline:none;
  border-color:#4e54c8;
  box-shadow:0 0 8px rgba(78,84,200,.25);
}
textarea{resize:none}
button{
  width:100%;
  margin-top:22px;
  padding:14px;
  border:none;
  border-radius:12px;
  background:linear-gradient(90deg,#11998e,#38ef7d);
  color:#fff;
  font-size:15px;
  font-weight:600;
  cursor:pointer;
  transition:.3s;
}
button:hover{
  transform:translateY(-2px);
  box-shadow:0 8px 18px rgba(17,153,142,.4);
}
#status{
  margin-top:15px;
  text-align:center;
  font-weight:600;
  font-size:14px;
  min-height:20px;
}
.success{color:#155724}
.error{color:#721c24}
small{
  font-size:12px;
  color:#666;
  display:block;
  margin-top:6px;
}
@keyframes fadeIn{
  from{opacity:0;transform:translateY(-15px)}
  to{opacity:1;transform:translateY(0)}
}
footer{
  margin-top:20px;
  text-align:center;
  font-size:12px;
  color:#eee;
}
</style>
</head>

<body>

<div class="container">
  <h2>ADMIN SETTING</h2>

  <label>Limit Off / Cuti per Hari</label>
  <input type="number" id="maxHarian" min="1">

  <label>Limit Libur per User</label>
  <input type="number" id="maxUser" min="1">

  <label>Special Holiday</label>
  <textarea id="specialHoliday" rows="3"
    placeholder="YYYY-MM-DD,YYYY-MM-DD"></textarea>
  <small>Contoh: 2026-01-01,2026-01-16</small>

  <button onclick="saveConfig()">üíæ SIMPAN SETTING</button>
  <div id="status"></div>
</div>

<footer>¬© 2025 EDP Fai</footer>

<script>
/* ===================== KONFIG ===================== */
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzgQGMsvpbwlg2aSS8DC3-FGrzRkgz_LKOGFuWwbMSaThqMa8Eftghmdx1IPXldyA9QQQ/exec";

/* ===================== LOAD SETTING ===================== */
async function loadConfig(){
  const status = document.getElementById("status");
  status.textContent = "‚è≥ Memuat setting...";

  try{
    const res = await fetch(SCRIPT_URL + "?mode=config");
    const cfg = await res.json();

    document.getElementById("maxHarian").value = cfg.MAX_KUOTA_HARIAN || "";
    document.getElementById("maxUser").value   = cfg.MAX_LIBUR_USER || "";
    document.getElementById("specialHoliday").value = cfg.SPECIAL_HOLIDAYS || "";

    status.textContent = "‚úîÔ∏è Setting dimuat";
    status.className = "success";
  }catch(err){
    status.textContent = "‚ùå Gagal memuat setting";
    status.className = "error";
  }
}

/* ===================== SAVE SETTING ===================== */
async function saveConfig(){
  const status = document.getElementById("status");
  status.textContent = "‚è≥ Menyimpan setting...";
  status.className = "";

  const fd = new FormData();
  fd.append("mode","saveConfig");
  fd.append("MAX_KUOTA_HARIAN", document.getElementById("maxHarian").value);
  fd.append("MAX_LIBUR_USER", document.getElementById("maxUser").value);
  fd.append("SPECIAL_HOLIDAYS", document.getElementById("specialHoliday").value.trim());

  try{
    const res = await fetch(SCRIPT_URL,{
      method:"POST",
      body:fd
    });
    const json = await res.json();

    if(json.status==="success"){
      status.textContent = "‚úÖ Setting berhasil disimpan";
      status.className = "success";
    }else{
      status.textContent = "‚ùå Gagal menyimpan setting";
      status.className = "error";
    }
  }catch(err){
    status.textContent = "‚ùå Error koneksi ke server";
    status.className = "error";
  }
}

loadConfig();
</script>

</body>
</html>
