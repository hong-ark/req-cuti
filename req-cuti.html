<script>
async function cekNIK() {
  const nik = document.getElementById("nik").value.trim();
  const hasil = document.getElementById("hasil");
  const btnForm = document.getElementById("formCutiBtn");

  if (!nik) {
    hasil.innerText = "⚠️ Silakan masukkan NIK.";
    btnForm.style.display = "none";
    return;
  }

  hasil.innerText = "🔄 Mencari data...";
  btnForm.style.display = "none";

  try {
    // Pastikan URL Google Apps Script Anda benar-benar berfungsi dan di-deploy!
    const response = await fetch(`https://script.google.com/macros/s/AKfycbz2Vcne0S9qUcVGCNan2ChqwcPdcqKbHVh3RdnCdK5e-UktyDu-uxVO_5uGccRQtctU/exec?nik=${nik}`);
    const data = await response.json();

    if (data.nama && data.group) {
      hasil.innerHTML = `
        ✅ Nama: <strong>${data.nama}</strong><br>
        📌 Group: <strong>${data.group}</strong>
      `;
      btnForm.style.display = "block";
      btnForm.dataset.nama = data.nama;
      btnForm.dataset.nik = nik;
      btnForm.dataset.group = data.group;
    } else {
      hasil.innerText = "❌ NIK tidak ditemukan di database.";
    }
  } catch (err) {
    hasil.innerText = "❌ Gagal mengambil data. (Cek log konsol)";
    console.error("Error Fetching Data:", err);
  }
}

function lanjutForm() {
  const btn = document.getElementById("formCutiBtn");
  const nama = encodeURIComponent(btn.dataset.nama);
  const nik = encodeURIComponent(btn.dataset.nik);
  const group = encodeURIComponent(btn.dataset.group);

  // Menghubungkan ke form-request.html dengan Query String
  const formURL = `form-request.html?nik=${nik}&nama=${nama}&group=${group}`;

  window.location.href = formURL;
} // <-- Perhatikan: Hanya satu kurung kurawal penutup untuk fungsi lanjutForm
</script>
