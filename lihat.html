<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Data Request Libur & Cuti</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --primary:#1976d2;
  --primary-dark:#125aa3;
  --bg:#f4f6f8;
  --card:#ffffff;
  --border:#e0e0e0;
  --text:#333;
}

/* ===== BASE ===== */
body{
  margin:0;
  font-family:"Poppins","Segoe UI",Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
}

/* ===== STICKY HEADER ===== */
.header{
  background:linear-gradient(135deg,#2193b0,#6dd5ed);
  color:#fff;
  text-align:center;
  padding:22px 16px;
  position:sticky;
  top:0;
  z-index:3000;
  box-shadow:0 4px 12px rgba(0,0,0,.15);
}
.header h1{
  margin:0;
  font-size:1.5rem;
  font-weight:800;
}

/* ===== STICKY ACTION BAR ===== */
.actions{
  background:var(--bg);
  position:sticky;
  top:82px;
  z-index:2500;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
  padding:14px 16px;
  border-bottom:1px solid var(--border);
}

.btn{
  background:linear-gradient(135deg,var(--primary),#42a5f5);
  color:white;
  border:none;
  padding:12px 26px;
  border-radius:999px;
  font-weight:800;
  cursor:pointer;
  display:flex;
  align-items:center;
  gap:8px;
  box-shadow:0 6px 14px rgba(25,118,210,.35);
  transition:.25s;
}
.btn:hover{
  background:linear-gradient(135deg,var(--primary-dark),#1e88e5);
  transform:translateY(-2px);
}
.btn.loading{
  opacity:.7;
  pointer-events:none;
}

.hint{
  font-size:.85rem;
  color:#555;
}

/* ===== CONTENT ===== */
.container{
  max-width:1400px;
  margin:auto;
  padding:0 16px 40px;
}

/* ===== TABLE DESKTOP ===== */
.card{
  background:var(--card);
  border-radius:18px;
  box-shadow:0 8px 22px rgba(0,0,0,.12);
  overflow:hidden;
  margin-top:10px;
}

table{
  width:100%;
  border-collapse:collapse;
  font-size:13px;
}

th,td{
  padding:10px 12px;
  border-bottom:1px solid var(--border);
  text-align:left;
  white-space:nowrap;
}

th{
  background:var(--primary);
  color:white;
  position:sticky;
  top:132px;
  z-index:2000;
}

tr.bdl{background:#fff1ea;}
tr.smg{background:#eef4ff;}
tr.yog{background:#fff8db;}

.loading{
  text-align:center;
  padding:24px;
  font-weight:600;
  color:#666;
}

.footer{
  text-align:center;
  margin-top:18px;
  font-size:.8rem;
  color:#777;
}

/* =================================================
   ðŸ“± MOBILE CARD MODE (RAPI & TIDAK BERANTAKAN)
================================================= */
@media(max-width:768px){

  table,thead,tbody,th,tr{
    display:block;
  }

  thead{
    display:none;
  }

  tr{
    background:white!important;
    margin-bottom:14px;
    border-radius:14px;
    padding:12px;
    box-shadow:0 4px 12px rgba(0,0,0,.1);
  }

  td{
    display:flex;
    justify-content:space-between;
    padding:6px 0;
    white-space:normal;
    border:none;
    font-size:.85rem;
  }

  td::before{
    content:attr(data-label);
    font-weight:700;
    color:#555;
    padding-right:10px;
  }
}
</style>
</head>

<body>

<div class="header">
  <h1 id="pageTitle"></h1>
</div>

<div class="actions">
  <button id="loadBtn" class="btn" onclick="loadData()">
    <span id="btnIcon">ðŸ”„</span>
    <span id="btnText">Muat Data</span>
  </button>
  <div class="hint">Data request bulan berjalan</div>
</div>

<div class="container">

  <div class="card">
    <div id="loading" class="loading">
      Klik <b>Muat Data</b> untuk menampilkan data
    </div>
    <table id="tbl"></table>
  </div>

  <div class="footer">
    Data bersifat informasi Â· Read-only
  </div>
</div>

<script>
/* ===== JUDUL OTOMATIS +1 BULAN ===== */
function setAutoTitle(){
  const bulan=["JANUARI","FEBRUARI","MARET","APRIL","MEI","JUNI","JULI","AGUSTUS","SEPTEMBER","OKTOBER","NOVEMBER","DESEMBER"];
  const now=new Date();
  const target=new Date(now.getFullYear(),now.getMonth()+1,1);
  document.getElementById("pageTitle").textContent=
    `DATA REQUEST LIBUR - CUTI BULAN ${bulan[target.getMonth()]} ${target.getFullYear()}`;
}
setAutoTitle();

const GAS_URL="https://script.google.com/macros/s/AKfycbzR8nCWg3vWMLd9ZWbvOTDR9bwdZ8xLpr7dQAfLyzZka32Qf9gsswpKQgLRUPFl8yA93Q/exec?api=req";
const VISIBLE_COLS=[1,2,3,4,5,6,7];

function loadData(){
  const btn=document.getElementById("loadBtn");
  btn.classList.add("loading");
  document.getElementById("btnIcon").textContent="â³";
  document.getElementById("btnText").textContent="Memuat...";

  fetch(GAS_URL)
    .then(r=>r.json())
    .then(data=>{
      render(data);
      btn.classList.remove("loading");
      document.getElementById("btnIcon").textContent="ðŸ”„";
      document.getElementById("btnText").textContent="Refresh Data";
    })
    .catch(()=>{
      document.getElementById("loading").textContent="âŒ Gagal memuat data";
    });
}

function render(data){
  const tbl=document.getElementById("tbl");
  tbl.innerHTML="";
  document.getElementById("loading").style.display="none";

  const headers=data[0].filter((_,i)=>VISIBLE_COLS.includes(i));

  data.slice(1).forEach(row=>{
    const tr=document.createElement("tr");

    headers.forEach((h,idx)=>{
      const td=document.createElement("td");
      td.setAttribute("data-label",h);
      td.textContent=row[VISIBLE_COLS[idx]] ?? "";
      tr.appendChild(td);
    });

    const g=row[3];
    if(g==="BDL-PLG-KAL") tr.classList.add("bdl");
    if(g==="SMG-CRB") tr.classList.add("smg");
    if(g==="YOG") tr.classList.add("yog");

    tbl.appendChild(tr);
  });
}
</script>

</body>
</html>
