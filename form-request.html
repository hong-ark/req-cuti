function doGet(e) {
  const ss = SpreadsheetApp.openById("1C0QEWn7BlRTqaSvw01km0TIUIhQEJeR1c4y0BsY1Fz4");
  const sheet = ss.getSheetByName("JAWABAN");
  const data = sheet.getDataRange().getValues();
  const nik = e.parameter.nik;

  if (!nik) {
    return ContentService.createTextOutput(JSON.stringify({ error: "NIK tidak ditemukan" }))
      .setMimeType(ContentService.MimeType.JSON);
  }

  let lastEntry = null;
  for (let i = data.length - 1; i >= 2; i--) {
    if (String(data[i][1]) === String(nik)) {
      lastEntry = {
        libur: data[i][4],
        cuti: data[i][5],
        requestLainnya: data[i][6],
        ekstrakulikuler: data[i][7]
      };
      break;
    }
  }

  return ContentService.createTextOutput(JSON.stringify(lastEntry || {}))
    .setMimeType(ContentService.MimeType.JSON);
}
